
---
title: 为什么要使用IOC容器
tags: spring,读书笔记
---

控制反转（Inversion of Control，缩写为IOC) 是一种设计原则.不再由依赖对象去创建,而是由IOC容器负责创建并且在软件运行过程中动态注入依赖.


一般情况下,当对象A依赖对象B时,需要在对象A中`new`一个对象实例B的实例.

```java
public class A{
    private B b = new B();
}
```

这是一个简单的例子.通过这个例子无法看出使用IOC的好处.

但是在实际情况里, 可不是简简单单new 一个对象就完事了.

被依赖的对象有可能依赖其他对象,这种情况下代码会变成这样 : 


```java
public class A{
    private C depforB1 = new C();
    private D depforB2 = new D();
    private B b = new B(depforB1,depforB2);
}
```

实际情况可能更加复杂.比如C和D还有各自的依赖.C和D的依赖还有各自的依赖.最后依赖层级越来越多,子子孙孙无穷尽也.

可以看出,在代码规模很大的情况下,每次编写创建依赖都将是一个沉重的负担.

------

那么使用了IOC容器的情况是怎么样呢?

以Spring 的依赖注入作为例子.如果我们需要在对象A里使用对象B的实例,只需要通过`@Autowired`注解告诉框架即可:

```java
public class A{

    @Autowired
    private B b;

}
```

使用者不需要关心创建对象B的过程.因为这个过程由IOC容器代劳了.

有了IoC容器后，把创建和查找依赖对象的控制权交给了容器，由容器进行注入组合对象，所以对象与对象之间是 松散耦合，这样也方便测试，利于功能复用，更重要的是使得程序的整个体系结构变得非常灵活.

另外,AOP的两种代理实现方式.都需要修改原来的对象.如果没有获得对象的创建权,AOP也就无从谈起.

-----------

