
---
title: 关于mysql事务四大特性的个人理解
tags: mysql,读书笔记
---

什么是数据库的事务？事务其实就是单个数据逻辑单元组成的对象操作集合，而数据库的终极目标就是使数据库从一个一致的状态转换到另一个一致的状态，这就是ACID中的一致性（Consistency），而原子性（Atomicity）、隔离性（Isolation）、持久性（Durability）是为了实现这个目标的手段。

## 原子性

 一个事务是一连串的操作组成，增删改查的集合。

而事务的原子性就要求整个事务中的所有操作要么全部成功,要么全部失败回滚.对于一个事务而言,不可能只执行其中的一部分操作.所以原子性就好比一个Java方法,要么所有语句全部执行成功,要么执行失败回滚.不会出现执行一半的情况.

## 持久性

好的，这时候我们假设原子性保证了.一个事务未提交的时候，发生了错误就执行rollback，那么事务就不会提交了.

但是当我们事务执行成功了，执行commit指令之后，遇到了错误会怎么样？

我们都知道 提交事务以后会将数据刷盘,,进行持久化操作.而在这个刷盘过程中出现停电,宕机等可以中断刷盘的操作,那么这个过程中会不会出现有一半数据刷盘成功,另一半没刷进去?

当然不会,事务的持久性保证了事务一旦完成,它对数据库的改变是永久性的,即使系统出现故障.

## 隔离性

原子性，持久性是事务一致性的充分条件,但是还无法构成必要条件.这两个都解决了,接下来就是并发访问时的一致性问题了.

回到隔离性，很显然事务的隔离性，说的就是，事务并发时,事务的修改结果在什么时候能被其他事务看到.

在java中我们使用锁和`volatile`关键字来保证其他线程不会读取到修改变量的中间值,只能读取到初始值和修改完成以后的值.但是这些都是你根据业务来操作的，所以数据库为我们封装了‘四把锁’，对应四种隔离级别：

1. 读未提交，其隔离级别最低，允许脏读。换句话说就是，如果一个事务正在处理某一数据，并对其进行了更新，但是同时没有提交事务，允许另一个事务也可以访问

2. 读已提交，和���未提交的区别就是。读未提交可以读取到别人没有提交的数据，但是读已提交只能读取到别人提交后的值，事务进行的中间值不会读取到

3. 可重复读，简单来说就是事务处理过程中多次读取同一个数据的时候，这个值不会发生改变，其值都和第一次查询到的数据是一致的

4. 可串行化，是最严格的隔离级别，他要求所有的事务都被串行执行，既事务只能一个接一个的进行处理，不能并发执行

   这样原子性、持久性、隔离性(锁机制以及各种并发安全控制机制)和事务一致性就构成了充分必要条件
